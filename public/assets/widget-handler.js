!function(){"use strict";window.spMessengersWidget={};var e=JSON.parse(localStorage.getItem("spMessengersWidgets"))||{};window.spMessengersWidget.init=function(){var n=document.querySelector(".sendpulse-msg-widget-wrap").getAttribute("lang"),s=document.getElementsByClassName("sp-widget"),o={};for(var r in"function"!=typeof NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),Array.from(s).forEach((function(t){for(var n in t.dataset.messengers||(t.dataset.messengers='{"messenger":true}'),JSON.parse(t.dataset.messengers))JSON.parse(t.dataset.messengers)[n]&&(o[n]=!0);!function(t){var n=/sp-button|sp-embed|sp-checkbox|sp-chat/.exec(t.className),s=t.dataset.showOptions?JSON.parse(t.dataset.showOptions):{condition:"onEnter"};if(a(t.id)||i())return!1;n&&(s.condition="showNow");switch(s.condition){case"onEnter":setTimeout((function(){return d()}),1e3*s.delay);break;case"onScroll":window.addEventListener("scroll",o);break;case"onCursorLeave":document.body.addEventListener("mouseleave",r);break;default:d()}function o(){var e=(document.body.scrollHeight-window.innerHeight)/100*s.scrollTo;window.scrollY>=e&&(window.removeEventListener("scroll",o),d())}function r(e){(e.clientY<=0||e.clientX<=0||e.clientX>=window.innerWidth||e.clientY>=window.innerHeight)&&(document.body.removeEventListener("mouseleave",r),d())}function i(){return s.hideOnMobile&&window.screen.availWidth<600}function a(t){var n=e[t];if(n&&n.closed&&(((new Date).getTime()-e[t].lastShowed)/864e5<s.repeat||!s.repeat||0===s.repeat))return!0;return!1}function d(){var n=t.nextElementSibling;t.classList.remove("sp-hidden"),t.classList.add("sp-animation-fade"),n&&(n.style.display="block"),e[t.id]={lastShowed:(new Date).getTime()},localStorage.setItem("spMessengersWidgets",JSON.stringify(e)),c()}function c(){setTimeout((function(){var e=document.getElementById("fb-send-to-messenger-fallback-btn");e&&"0px"===document.querySelector(".fb-send-to-messenger > span").style.width&&(document.querySelector(".fb-send-to-messenger").style.display="none",e.style.display="inline-block")}),1e3)}}(t)})),o)o[r]&&t[r](n);!function(){var e={ru:"Предоставлено SendPulse",en:"Powered by SendPulse",uk:"Надано SendPulse",de:"Unterstützt von SendPulse"},t=window.navigator.language.slice(0,2),n=e[t]||e.en;Array.from(document.querySelectorAll("sp-branding")).forEach((function(e){e.setAttribute("title",n);var t=e.getElementsByTagName("span")[0];t&&(t.innerText=n),/.ru$/.test(location.host)&&(e.style.display="none")}))}()},window.spMessengersWidget.close=function(t){var n=document.getElementById(t);e[t]={lastShowed:(new Date).getTime(),closed:!0},localStorage.setItem("spMessengersWidgets",JSON.stringify(e)),function(e){var t=e.nextElementSibling;e.classList.add("sp-hidden"),t&&(t.style.display="none")}(n)},window.spMessengersWidget.submit=function(e){var t=document.getElementById(e).querySelector("[data-ref]"),n={app_id:t.getAttribute("messenger_app_id"),page_id:t.getAttribute("page_id"),ref:t.getAttribute("data-ref"),user_ref:t.getAttribute("user_ref")};window.FB.AppEvents.logEvent("MessengerCheckboxUserConfirmation",null,n)};var t={messenger:function(t){function n(){window.FB.init({appId:document.querySelector("[messenger_app_id]").getAttribute("messenger_app_id"),autoLogAppEvents:!0,xfbml:!0,version:"v3.1"}),window.FB.Event.subscribe("send_to_messenger",(function(t){var n=t.ref;if("undefined"!==n){var s=JSON.parse(decodeURIComponent(atob(n))).widget_id;if("opt_in"===t.event){var o=document.getElementById("spSubscribe-".concat(n)),r=document.getElementById("spSubscribed-".concat(n)),i=document.getElementById(s).className;o.style.display="none",r.style.display="block",e[s]={lastShowed:(new Date).getTime()},-1===i.search(/.*(sp-embed|sp-button).*/)&&(e[s].closed=!0),localStorage.setItem("spMessengersWidgets",JSON.stringify(e))}}})),window.FB.Event.subscribe("xfbml.render",(function(){var e=document.querySelector(".sp-chat-logo");e&&(e.style.display="block")}))}var s,o,r,i,a,d;window.FB?n():window.fbAsyncInit=n,s=document,o="script",r="facebook-jssdk",i=t,d=s.getElementsByTagName(o)[0],s.getElementById(r)||((a=s.createElement(o)).id=r,a.src="https://connect.facebook.net/".concat(i,"/sdk/xfbml.customerchat.js"),d.parentNode.insertBefore(a,d))},vk:function(){var e=document.createElement("script");e.src="//vk.com/js/api/openapi.js?162",e.onload=function(){document.querySelectorAll(".vk-allow-messages-button").forEach((function(e){var t=e.id.split("-")[1];window.VK.Widgets.AllowMessagesFromCommunity(e.id,{height:{standard:22,large:24,xlarge:30}[e.dataset.size]},t)})),window.VK.Observer.subscribe("widgets.allowMessagesFromCommunity.allowed",(function(e){var t=document.querySelectorAll(".vk-allow-messages-button")[0].dataset.ref,n=new XMLHttpRequest;n.open("POST","https://vk.sendpulse.com/widget/subscribe/"),n.send(JSON.stringify({ref:t,user_id:e}))}))},document.head.appendChild(e)},telegram:function(){var e=document.getElementsByClassName("sendpulse-tg-button-holder ");Array.from(e).forEach((function(e){e.onclick=function(){var t=new XMLHttpRequest,n=e.querySelector("a").search.split("=")[1],s=JSON.parse(decodeURIComponent(atob(e.dataset.ref))),o=[];for(var r in s.contact_variables)o.push({name:r,value:s.contact_variables[r]});t.open("POST","https://login.sendpulse.com/api/telegram-service/guest/widget-payload"),t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),t.send(JSON.stringify({payload_id:n,widget_id:s.w,data:{contact_variables:o}}))}}))},whatsapp:function(){},instagram:function(){document.querySelectorAll(".sendpulse-send-to-ig").forEach((function(e){var t=e.getAttribute("href");for(var n in window.oSpP)t+="|".concat(n,"=").concat(window.oSpP[n]);e.setAttribute("href",t)}))}}}();